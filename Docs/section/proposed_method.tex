\section{提案手法}
%第\ref{sec:related-works}で述べたように，これまでに提案されてきた検知に基づくDNS Tunneling対策には，Low Throughput手法および転送頻度を下げる手法に対して，検知が困難であるという課題がある．
%他方，新しいアーキテクチャに基づく名前解決システムには，マイグレーションの課題が残留している．
本章では，はじめに提案手法の概要について説明する．
続いて，システムの具体的なアーキテクチャ・プロトコル・動作について説明する．

\subsection{分散ハッシュテーブルを利用した名前解決システム : REVRES}
関連研究の課題~\ref{sec:issue-past-works}で示すように，これまでの対策手法ではDNS Exfiltrationに対処するには限界がある．
そこで，提案する新しい名前解決システムが，分散ハッシュテーブルをサーバ群で連携させ，クライアントからの名前解決問い合わせに対する応答サーバをランダムにさせることで，情報流出のメソッドとして利用されるDNS Exfiltrationの発生を抑止する名前解決システム，REVRES(REcord Value Resolution System)である．

\subsection{アーキテクチャ}
REVRESは，サーバ同士が相互連携するサーバ群とクライアントで構成されるクライアントサーバアーキテクチャで動作する．
REVRESにおいて，スタブリゾルバとフルサービスリゾルバとの間の手続きは，既存のDNSと変わらない．
しかし，REVRESのサーバは，フルメッシュのネットワーク基盤のもとで各サーバが相互に連携することで，リソース情報を分散して管理する．
%既存のDNSにおける名前解決の仕組みでは，階層的なドメイン構造に基づきルートから順に権威サーバに対し再帰的に問い合わせていくことで，スタブリゾルバからの問い合わせレコード情報を保持するサーバのアドレスを特定する．
REVRESにおけるレコード情報は，QNAMEとレコードタイプを引数として，ハッシュ関数によって算出されるコンテンツIDがシンボルとして紐づけられる．

全てのフルサービスリゾルバは，シンボルとそのシンボルに紐づいたレコード情報を管理するサーバを対応づけた表を保持し，この対応表に基づきコンテンツIDからサーバを一意に特定する．
複数のサーバが，アルファベットおよび数字の順序(a $\rightarrow$ z, 0 $\rightarrow$ 9)で並んだハッシュテーブルの連続した範囲を管理し合い，担当の範囲下にあるコンテンツIDに紐づいたレコード情報を担当サーバが管理する．
対応表~\ref{tab:hash-management}には，どこからのどこまでのハッシュテーブルの範囲をどのサーバが管理するのかについて記述されている．

\input{table/managemnt_range}

フルサービスリゾルバはQNAMEとリソースレコードタイプをキーとしてサーバに問い合わせるバリューが応答されるKVSモデルに基づく名前解決システムである．

QNAMEとリソースレコードタイプに基づき生成されるハッシュ値をキー，分散ハッシュテーブル上で保存されているレコード情報をバリューとするKVSモデルに基づく名前解決システムである．

REVRESでは，従来のDNSのエコシステムの内，スタブリゾルバからリカーシブサーバまでの手続きを継承することで，エッジノードにおけるシステムのマイグレーションに伴う課題を軽減する．
全てのレコード情報は，レコードタイプとドメイン名もしくはIPアドレスの文字列和(rtype+domain, rtype+ipaddress)をハッシュ関数に適用して算出されるハッシュ値をコンテンツIDとして，レコード情報に紐づっけr．




スタブリゾルバは既存のDNSと変更はなく，DNSクライアントとして，名前解決を依頼する主体として位置づくノードである．
リカーシブサーバは，スタブリゾルバからの問い合わせに対してリソース情報を保持する主体に代理的に問い合わせ機能と，問い合わせた情報を一定期間キャッシュするキャッシュサーバとして機能するノードである．
既存のDNSにおける権威サーバは，リカーシブサーバからの問い合わせに応答するマネージャと，リソース情報について作成・消去および更新などの操作をするプロバイダの二つに分けられる．
REVRESにおいて，リソース情報は，オブジェクト(object)とリソースレコードタイプ(rtype)を引数とするハッシュ関数から算出されるコンテンツIDが紐づけられ，そのコンテンツIDに基づきハッシュ空間上に対応づけられる．
各マネージャは，ハッシュテーブル全体のうち連続した幾らかの管理範囲が割り当てられ，範囲下にあるコンテンツIDに基づいたリソース情報を保存・管理する．
このようにして，リソース情報は，特定の範囲ごとに分割されたハッシュテーブルにて分散的に管理される．
マネージャ同士は，フルメッシュなネットワーク構造で接続し合い，各マネージャには地理的・意味的に類似なプロバイダが階層的な序列に基づき接続される．

プロバイダからリソース情報への操作リクエストがあった際には，リソース情報のコンテンツIDを算出し，そのIDが含まれるハッシュ空間を管理する担当マネージャに操作依頼を転送し，受け取った担当マネージャは直ちに，リソース情報への操作を実行する．


%\begin{figure}[h]
% \centering
% \includegraphics[width=10.0cm]{images/spnrs-architecture.png}
% \caption{REVRESによって，名前解決している様子．}
% \label{fig:spnrs-architecture}
%\end{figure}


%\subsubsection{想定する脅威}
%\subsubsection{名前解決メカニズム}
\subsection{プロトコル}
\subsection{分散ハッシュテーブル}
\subsection{動作メカニズム}
\subsection{ハッシュ範囲に対する管理ノードの対応表}
%\subsubsection{QNAMEとRRを引数とするハッシュ値をキーとするクエリ}
%\subsection{データベース}
