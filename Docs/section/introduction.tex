\section{序論}
\subsection{背景}
%APT攻撃のような用意周到に秘匿通信する手法が利用されている背景から入る方がいいのかもしれない．
%他には，セキュリティ脅威対策におけるSOCエンジニアの業務の大半が誤検知とのハンドリングに時間を取られている背景から入るとか
%膨大なセキュリティアラートにおける優先度やアラートが誤検知であるのかないのかの判別に業務が取られるているという報告がある．
%これを引き合いに対して，そもそも設計の脆弱性を廃止することの必要性について問題提起するとか
増加のし続けるサイバー攻撃に対して，多くの組織では，SIEMやEDRといったアラートシステムを導入し，収集される脅威情報を監視・分析することで攻撃に対処している．
アラートシステムに検知されなかった場合は，対処することは困難であり，インシデントが終了した後で攻撃に気づくという最悪の可能性もある．
他方で，網羅性を向上を目的として検知の閾値を下げた場合，肥大化したアラート情報から重大な脅威を優先度をつけ処理していく作業はセキュリティの担当者に大きな負担になる．
このようにセキュリティの被害に対処することは困難であるため，脅威が発生しにくいセキュアなシステムの設計が重要である．

ドメインネームシステム(Domain Name System, DNS)は，ドメイン名に関連づけられたリソースレコード情報を解決する機能を持つプロトコルであり，現在のインターネットにおいて極めて重要な役割を担うため，多くの組織ではフィルタリングされることが少ない．
しかし，DNSには，様々なセキュリティの脅威が残っている．
その中で，DNSをデータの転送キャリアとして機能させるDNSトンネリングは，その検知困難性から多くの攻撃者に利用される秘匿手法の一つである．
DNSトンネリング手法を利用することで，SIEMやEDRといったセキュリティラインが引かれたネットワークから，容易に情報を流出させたり，逆に情報を外部から取得することができる．
DNSトンネリング手法を利用したインシデントでは，過去には〜件のクレジットを流出されるといった大規模な
%他方で，性善説的な当時の設計にはセキュリティやプライバシーが考慮されておらず，DNSには様々な課題が残っており，また設計の脆弱性を悪用した攻撃手法も多数報告されている．
%その設計に起因する課題の内，DNSクエリのラベルおよびリソースレコード(Resource Record, RR)をデータ転送のメディアとするDNS Tunnelingがある．

このように本来の目的とは違う方法でデータを転送する手法は，一般に秘匿通信(Covert Channel)と呼ばれる~\cite{covertchannel}．
DNS Tunnelingは，秘匿通信の代表例であり，マルウェアとC2(Command \& Control)サーバとの通信の秘匿手法，または，ターゲットから取得したデータを外部に流出させるといった目的実行の手段として，実際のインシデントで広く利用されている~\cite{frameworkpos, bondupdater, bernhardpos, multigrainpos, pisloader, denis, dnsmessenger, udpos}．
%2014年には，発生した大規模なクレジットカード情報流出事件\cite{}，最近では2019年に発生したAPTグループ(通称,OilRig)による中東政府を標的とするサイバー攻撃のC2通信\cite{bondupdater}として実際のインシデントなどがある．
%このDNS Tunnelingのメカニズムは，スタブリゾルバからリカーシブサーバを経由し権威サーバへ問い合わせる一連の正規の仕組みに基づいており，名前解決を実現するにあたり生じる設計上の脆弱性を突いた手法である．
DNS TunnelingによるDNSクエリは，転送量に比例して長いラベルを持ち，ラベルとしての文字列制約を満たすためのエンコーディングによって高いエントロピーを示す特徴がある．

%\begin{eqnarray}
% \label{eq:sample_qname}
% \begin{aligned}
%  &obqxg43xmqytcmjr.exfil.com\\
%  &base32(password1111) = obqxg43xmqytcmjr
% \end{aligned}
%\end{eqnarray}

また，インタラクティブなシェルなど双方向の通信をDNS Tunnelingで実現しようとする場合，時間あたりに高頻度なトラフィックが発生するという特徴が現れる．
このような特徴に基づき，パターンマッチングや機械学習，文字列分布などのメソッドを用いた検知手法が過去に多数考案されてきた~\cite{born, cheng, liu, asaf, steadman, jawad}．
それら検知手法は，高い精度で分類を実現しているものがあるが，DNS Tunnelingとして検知する対象としているパケットには一般に利用することができるDNS Tunnelingツールキット~\cite{ozymandns, iodine, dnscat2}が使用され，それらは特に過剰な特徴量を示し，明らかに正規のDNSクエリと異なる特徴がある．
高い精度を示す従来の検知手法だが，しかし，それらを迂回する手法として，1回あたりの転送データ量を少なくすることで特徴量を減らすLow Throughputなバイパス手法，また，パケット間のインターバルを数日・数ヶ月と長期化させることでファイル肥大から一定期間しか保存されることがないログ管理の隙間を突いたSlowなTunenling手法があり，従来の検知手法では対応することが困難である．
悪意を持つユーザの視点として，1bitでも転送できることは秘匿通信として利用することができるため，転送量の少なさは軽視されるべきではない．

他方で，DNSは初めに述べたように，現在のインターネットの根幹技術として根ざしており，抜本的な改変は期待されない．
すなわち，既存のDNSによる名前解決のメカニズムに大幅な改変を加えないという制約下で，Tunnelingに対処することが現実的な最適解であると考える．


\subsection{目的}
本研究では，既存のDNSの名前解決メカニズムの大部分を流用することが一部の改変に留めながら，DNSを用いたデータ転送としての機能の排除を実現する次世代の名前解決メカニズムを提案する．
%\subsection{貢献点}
%本研究の貢献は，以下の通りである．
%\begin{itemize}
% \item 侵入通信を目的とするDNS Tunnelingに対するリアルタイム検知アルゴリズムの提案
% \item 既存対策アプローチとDNSの潜在的データ転送脅威モデルの検討
%\end{itemize}
%\subsubsection{脅威モデル}
%\subsubsection{仮説}




\subsection{本論構成}
%\ref{kako}節では、過去における研究について述べ、
%\ref{kadai}章では、現状と今後の課題について述べる。
%また、付録\ref{omake1}におまけその１を添付する。
本稿の構成は次の通りである．
第２章では，準備として，本論において核となる技術内容・特徴およびそのメカニズムについて説明する．
第３章では，関連研究としてトラフィックおよびペイロード特徴に基づいた検知手法を説明し，そのバイパス手法としてLow Throughput手法・Slow Tunneling手法があることを示す．
第４章では，提案手法を説明する．
第５章では，提案手法のDNS Tunnelingに対する評価を行い，併せて提案手法の特定についても説明する．
第６章では，提案手法の課題について議論する．
最後に，第７章にて結論を述べる．
