\documentclass[12pt]{jarticle} % Japanese
%\documentclass[12pt]{article} % English
% if there are problems in the above regarding fonts, use this
% \documentclass[UTF8]{ctexart}



%package
\usepackage{amsmath, newtxmath}
\usepackage[utf8]{inputenc}
%\usepackage{utf}
\usepackage{naist-jmthesis} %Japanese
%\usepackage{naist-mthesis} %English
\usepackage{graphicx}
\usepackage[dvipdfmx]{hyperref}
\usepackage{xcolor}
\usepackage{pxjahyper} %TOC文字化け対策



%definition
\definecolor{purple}{RGB}{98, 114, 164}
\hypersetup{
 colorlinks=true,
 linkcolor=black,
 citecolor=purple,
 urlcolor=purple,
 pdfborder={0, 0, 1},
 linktoc=all
}



% Page style
\pagestyle{final}       % Camera-Ready
%\pagestyle{draft}      % Draft
\lang{Japanese} % Japanese
%\lang{English} % English
% Student Number
\studentnumber{1811147}
\doctitle{\mastersthesis}       % 修士論文
\major{\engineering}    % 工学



% 日本語題目 (in LaTeX)
%\title{再帰問い合わせ名前解決へのハッシュ関数を用いたDNS Exfiltration緩和策の提案}
\title{DNS Exfiltrationの緩和を目的としたNon-Transparent DNS(NTDNS)の提案}
% 日本語題目 (in plain text)
%   注: (in LaTeX)と同じ場合は指定する必要なし。
%       この情報は修士論文/課題研究には現れませんが、管理のために必要です。
%\ptitle{再帰問い合わせ名前解決へのハッシュ関数を用いたDNS Exfiltration緩和策の提案}



% 英語題目 (in LaTeX)
%\etitle{Proposal for Mitigation of DNS Exfiltraion using Hash Function to Recursive Name Resolution}
\etitle{Proposal for Non-Transparent DNS(NTDNS) to Mitigate DNS Exfiltration}
% 英語題目 (in plain text)
%   注: (in LaTeX)と同じ場合は指定する必要なし。
%       この情報は修士論文/課題研究には現れませんが、管理のために必要です。
%\eptitle{Theoretical Studies on Low-Speed Calculation Algorithms of pi \\
%Utilizing the Sun and the Moon}
%\eptitle{Proposal for Mitigation of DNS Exfiltraion using Hash Function to Recursive Name Resolution}



% 日本語氏名 (in LaTeX)
%   （姓と名の間に空白を入れて下さい）
\author{高須賀 昌烈}
%\pauthor{}
%   （first name, last name の順に記入し、先頭文字のみを大文字にする。）
\eauthor{Shoretsu Takasuka}
% 別の例: \eauthor{Kurt G\"{o}del}
%\epauthor{}



% 論文提出年月日
\syear{2020}
\smonth{3}
\sday{15}



% 専攻の選択
%\department{\infproc}  % 情報処理学
%\department{\infsys}    % 情報システム学
%\department{\bioinf}   % 情報生命科学
\department{\infsci}    % 情報科学



% 審査委員（日本語）
%   （姓と名、名と称号の間に空白を入れて下さい）
%５人以上の場合，５人目以降は\addcmembers を使って宣言する。
%最大で合わせて８人まで宣言可能。
%主指導教員、副指導教員を明記する。両指導教員以外は委員。
%学外審査委員は、大学名を明記する
% ４人の場合
\cmembers{門林 雄基 教授}{（主指導教員）}
         {笠原 正治 教授}{（副指導教員）}
         {林 優一 教授}{（副指導教員）}
         {妙中 雄三 准教授}{（副指導教員）}
% ３人の場合
%\cmembers{○○ ○○ 教授}{（主指導教員）}
%         {○○ ○○ 教授}{（副指導教員）}
%         {○○ ○○ 准教授}{（副指導教員）}
%         {}{}
% ２人の場合
%\cmembers{○○ ○○ 教授}{（主指導教員）}
%         {○○ ○○ 教授}{（副指導教員）}
%          {}{}
%          {}{}



% 審査委員（英語）
%     （first name, last name の順に記入し、先頭文字のみを大文字にする。
%       first name と last name の間に空白、
%       last name と 称号の間にカンマと空白を入れて下さい。）
% ５人以上の場合，５人目以降は\eaddcmembers を使って宣言する
% Supervisor, Co-supervisor, and Member must be specified.
% ４人の場合
\ecmembers{Professor Youki Kadobayashi}{(Supervisor)}
          {Professor Shoji Kasahara}{(Co-supervisor)}
          {Professor Yu-ichi Hayashi}{(Co-supervisor)}
          {Associate Professor Yuzo Taenaka}{(Co-supervisor)}
% ３人の場合
%\ecmembers{Professor xx xx}{(Supervisor)}
%          {Professor xx xx}{(Co-supervisor)}
%          {Associate Professor xx xx}{(Co-supervisor)}
%          {}{}
% ２人の場合
% \ecmembers{Professor xx xx}{(Supervisor)}
%           {Professor xx xx}{(Co-supervisor)}
%           {}{}
%           {}{}
% キーワード５〜６個 (in LaTeX)
%\keywords{$\pi$, 天文学, 数学, 計算機, アルゴリズム}



% ===================キーワード===================
\keywords{ネットワークセキュリティ，Domain Name System(DNS)，秘匿通信，Tunneling，機械学習}
% キーワード５〜６個 (in plain text)
%   注: (in LaTeX)と同じ場合は記入する必要なし。
%       この情報は修士論文/課題研究には現れませんが、管理のために必要です。
%\pkeywords{pi, 天文学, 数学, 計算機, アルゴリズム}
%\pkeywords{DNS Exfiltration, 秘匿通信，ハッシュ関数，再帰問い合わせ}
% 5 or 6 Keywords (in LaTeX)
%\ekeywords{$\pi$, astronomy, mathematics, computer, algorithm}



% ===================Keyword===================
\ekeywords{Network Security, Domain Name System(DNS), Covert Channel, Machine Learning}
% 5 or 6 Keywords (in plain text)
%   注: (in LaTeX)と同じ場合は記入する必要なし。
%       この情報は修士論文/課題研究には現れませんが、管理のために必要です。
%\epkeywords{pi, astronomy, mathematics, computer, algorithm}
%\epkeywords{DNS Exfiltration, Covert Channel, Hash Function, Recursive Name Resolution}



% ===================内容梗概===================
\abstract{
}
%   注: 行の先頭が\\で始まらないようにすること。
%   注: (in LaTeX)と同じ場合は記入する必要なし。
%       この情報は修士論文/課題研究には現れませんが、管理のために必要です。
%       改行する箇所には空白行を入れる。
%       行の先頭が\\で始まらないようにすること。
%\pabstract{
%}
% Abstract (in LaTeX)
%  注: 　行の先頭が\\で始まらないようにすること。



% ===================Abstruct===================
\eabstract{
}
% Abstract (in plain text)
%   注: (in LaTeX)と同じ場合は記入する必要なし。
%       この情報は修士論文/課題研究には現れませんが、管理のために必要です。
%       改行する箇所には空白行を入れる。
%       行の先頭が\\で始まらないようにすること。
%\epabstract{
%The calculation of pi has been paid much attention since human beings
%appeared on the earth.
%This thesis presents novel low-speed algorithms to calculate
%pi utilizing the sun and the moon.
%This is a sample abstract. This is a sample abstract.
%}



% ===================表紙===================
\begin{document}
\titlepage
\cmemberspage
\firstabstract
\secondabstract



% ===================目次===================
\toc
\newpage
\listoffigures
%\newpage
\listoftables



% ===================本文===================
\newpage
\pagenumbering{arabic}
\section{序論}
\subsection{背景}
インターネットの利活用において，おおよそ全てのサービスの通信は，ドメインネームシステム(Domain Name System, DNS)による名前解決をきっかけとして開始される．
DNSの名前解決の機能を通じて，インターネット利用者は，インターネット上でのノードの住所を意味する人にとっては覚えにくいIPアドレス(E.g. 93.184.216.34)ではなく，人が認識しやすいドメイン名(E.g. www.example.com)を使用してサービスを利用することができている．
このように現在のインターネットの利便性を実現する上で，DNSは極めて重要な技術の一つである．

1987年，そのコンセプトとなるRFC1034, RFC1035(\cite{rfc1034, rfc1035})が公開されて以降なお現在まで，当時採用された名前解決の根幹の仕組みは変わることなく使用されている．
しかし，プライバシーやセキュリティの観点が現在ほど議論されていない当時の設計には，第三者からのトランザクションを覗く脅威やフルサービスリゾルバ(キャッシュサーバ)に対して偽の応答パケットをキャッシュすることで任意のページにユーザを誘導させる脅威などが問題になるなど，設計の不備に起因する問題が山積している状態にある．

\subsection{課題}
本研究では，DNSにおける課題の内，DNSをデータ転送のメディアとして利用することでファイヤー・ウォールやIDS/IPSなどのセキュリティラインを迂回するDNS Tunneling手法に焦点を当てている．
DNS Tunnelingは，2014年に発生した大規模なクレジットカード情報流出事件\cite{frameworkpos}や最近では2019年に発生したAPTグループ(通称,OilRig)による中東政府を標的とするサイバー攻撃のC2通信\cite{bondupdater}といった実際の攻撃ベクターにデータ転送フェーズに使用されることが明らかになっている．
上記以外にも，Tunnelingメソッドを使用したマルウェアによるインシデントは多数報告されている\cite{bernhardpos, multigrainpos, pisloader, denis, dnsmessenger, udpos}．

Tunnelingのメカニズムは，
すなわち，現在のDNSのメカニズム，スタブリゾルバがフルリゾルバを介在してコンテンツを所有する権威サーバへ問い合わせる仕組みには，本質的にデータ転送の機能としての側面があり，名前解決を実現するにあたり副次的に発生した設計上の脆弱であると考えることができる．
この脆弱な設計により，悪意を持つユーザによって正規の利用方法なDNS Tunnelingを用いることで容易にセキュリティラインを突破されるという具合である．

このDNS Tunnelingに対して，従来の対策アプローチは，そのほとんどが検知に焦点が当てられてきた．
DNS Tunnelingを用いた場合のQNAMEは，以下(\ref{eq:sample_qname})に示すように，一回あたりに転送するデータ量に比例して長いラベルを持つ特徴が現れる．

\begin{eqnarray}
 \label{eq:sample_qname}
 \begin{aligned}
  &obqxg43xmqytcmjr.exfil.com\\
  &base32(password1111) = obqxg43xmqytcmjr
 \end{aligned}
\end{eqnarray}

また，インタラクティブなシェルなど双方向の通信をDNS Tunnelingで実現しようとする場合，時間あたりに高頻度なトラフィックが発生するという特徴が現れることもある．
これまでの既存の検知アプローチでは，上記のような特徴に基づいて
以上のような特徴から，従来の検知アプローチは，QNAMEの長さやエントロピーの特徴を利用するペイロードベース検知手法とトラフィック頻度を特徴量とするトラフィックベース検知手法に大別することができる．

しかし，これら検知に基づくアプローチをバイパスする手法として，1回あたりの転送データ量を少なくすることで特徴量を減らすLow Throughputなバイパス手法や，パケット間のインターバルを数日・数ヶ月と長期化させることでファイル肥大から一定期間しか保存されることがないログ管理の隙間を突いたSlowなTunenling手法が提案されており，これらを利用することで既存の検知手法をバイパスされるリスクが残留している．

転送量が少ないとして軽視されるべきではなく，1bitでも複数組み合わせる事などによって多種多様な情報量を送受信できることを踏まえると，脅威である．
そこで，本研究では，従来の検知手法ベースのDNS Tunneling対策では対策することが困難なLow ThroughputおよびSLowなTunneling手法によるデータ流出を緩和するために，DNS Tunnelingが発生しない新しい名前解決メカニズムを提案する．

%となる特徴があることや，ラベルとして使用できる文字列制約のために，実際に転送したい文字列をBase32, Base64などのエンコーディング手法を利用する方法が用いられる傾向が多く，その影響で自然言語には現れないようなランダムな文字列の組み合わせとなるという特徴がある．


\subsection{目的}
\subsection{貢献点}
\begin{itemize}
 \item 侵入通信を目的とするDNS Tunnelingに対するリアルタイム検知アルゴリズムの提案
 \item 既存対策アプローチとDNSの潜在的データ転送脅威モデルの検討
\end{itemize}
%\subsubsection{脅威モデル}
%\subsubsection{仮説}
\subsection{本論構成}
%\ref{kako}節では、過去における研究について述べ、
%\ref{kadai}章では、現状と今後の課題について述べる。
%また、付録\ref{omake1}におまけその１を添付する。
本論の構成は，次の通りに構成されている．
第二章では，本論の内容への準備として，DNSプロトコル，Tunnelingメカニズム，秘匿通信，オンライン機械学習などの核となる技術要素について説明する．
第三章では，DNS Tunnelingに対する検知アプローチおよびセキュリティドリブンな次世代DNSプロトコルに関する先行研究を説明する．
第四章では，提案手法について説明する．
第五章では，提案手法の効果測定について，またその結果について説明する．
第六章では，提案手法および既存研究で対処しきれていない残留する脅威モデルについてまとめ，さらにDNSプロトコルにおけるリソースレコードの現状の使用方法の課題について説明する．
最後に，第七章にて結論を述べる．

\newpage
\section{準備}
本章では，本論において使用する用語及び技術について説明する．
\subsection{DNS}
\subsubsection{プロトコル概要}
インターネットの利活用において，おおよそ全てのサービスの通信は，ドメインネームシステム(Domain Name System, DNS)による名前解決をきっかけとして開始される．
DNSの名前解決の機能を通じて，インターネット利用者は，インターネット上でのノードの住所を意味する人にとっては覚えにくいIPアドレス(E.g. 93.184.216.34)ではなく，人が認識しやすいドメイン名(E.g. www.example.com)を使用してサービスを利用することができている．
このように現在のインターネットの利便性を実現する上で，DNSは極めて重要な技術の一つである．

DNSは，各権威サーバが固有のゾーンを管理することによる階層型分散データベースとして機能させている．
ドメインは通常，複数のラベルで構成されており，ラベルの区切り文字にはドットが使用されている．
階層の最上位に位置するルートはラベルを持たず，最も右に位置するラベルがTLDである．
最も一般的なレコードは，Aレコードであり，FQDNをIPv4アドレスにマッピングする．
ゾーンは，管理者が管轄するべき名前空間を意味する．
権威は，サブドメインへ委譲することが可能である．この機能は，NSレコードによって実現される．
\subsubsection{リソースレコード(RR)}
\subsubsection{国際化ドメイン名(IDN)}
\subsubsection{Tunnelingメカニズム}
%\subsubsection{その他課題}
\subsection{秘匿通信}
\subsubsection{ステガノグラフィ}
\subsubsection{代替プロトコル}
\subsection{オフライン機械学習}
\subsubsection{学習メソッドの概要}
%\subsection{暗号学的ハッシュ関数}
%\subsubsection{定義}
%\subsubsection{性質}


\newpage
\section{先行研究}
\subsection{パターンマッチングによる検知}
\subsubsection{シグネチャの限界}
\subsection{トラフィック特徴に基づいた悪性DNSクエリの検知}
%\subsubsection{概要}
\subsubsection{同一ドメインあたりのクエリ頻度}
\subsection{ペイロード特徴に基づいた悪性DNSクエリの検知}
%\subsubsection{概要}
\subsubsection{Qnameにおける文字列分布}
\subsubsection{Qnameにおける長さとエントロピー}
\subsubsection{Low ThroughputなTunnelingに対する検知手法}
\subsection{次世代DNS}
\subsubsection{概要}
\subsubsection{分散ハッシュテーブルベース - GNS(Gnu Name System)}
\subsubsection{Blockchainベース - Namecoin, Blockstack}
\subsection{本研究の位置づけ}



\newpage
\section{機械学習によるリアルタイム検知メソッド}
%\subsection{分散データベースを用いた再起問い合わせにおけるハッシュ関数の適用}
\subsection{概要}
\subsection{特徴量抽出}
\subsection{データセット}
\subsection{アルゴリズム}


\newpage
\section{評価}
\subsection{実験概要}
\subsection{使用ツールキット}
モデル実装に伴って．使用したツールキットを以下に示す．
\subsection{データセット}
\subsection{結果}
\subsection{課題}

\newpage
\section{議論}
\subsection{残留脅威モデル}
\subsubsection{Slow Throughput}
\subsubsection{Lowなトラフィック}
\subsubsection{人気ラベルへのマッピング}
\subsection{データキャリアとしてのリソースレコード}
\subsubsection{TXT - ドメイン検証}
\subsubsection{DNSKEY - 公開鍵検証}
\subsubsection{CNAME}
\subsection{今後の課題}

\newpage
\section{結論}


% ===================謝辞===================
\newpage
\acknowledgements
ご指導ご鞭撻賜りありがとうございました．




% ===================参考文献===================
% ここでは \reference を使って、自分でリストを作るか、BibTeX を使って
% リストをつくって下さい。この例では BibTeX を作るような形式になってい
% ます。
\newpage
%\reference
%\bibliographystyle{plain}
\begin{thebibliography} {25}\small
 \bibitem{rfc1034} P.V. Mockapetris. ``Domain names - concepts and facilities. RFC 1034 (INTERNET STANDARD)," November 1987. Updated by RFCs 1101, 1183, 1348, 1876, 1982, 2065, 2181, 2308, 2535, 4033, 4034, 4035, 4343, 4035, 4592, 5936.
 \bibitem{rfc1035} P.V. Mockapetris. ``Domain names - implementation and specification. RFC 1035 (INTERNET STANDARD)," November 1987. Updated by RFCs 1101, 1183, 1348, 1876, 1982, 1995, 1996, 2065, 2136, 2181, 2137, 2308, 2535, 2673, 2845, 3425, 3658, 4033, 4034, 4035, 4343, 5936, 5966, 6604."
 \bibitem{frameworkpos} KrebsonSecurity. ``Deconstructing the 2014 Sally Beauty Breach," May 2015. https://krebsonsecurity.com/2015/05/deconstructing-the-2014-sally-beauty-breach/. (accessd 2019-11-30).
 \bibitem{bondupdater} IronNet. ``Chirp of the PoisonFrog," February 2019. https://ironnet.com/blog/chirp-of-the-poisonfrog/. (accessd 2019-11-30).
 \bibitem{bernhardpos} Nick Hoffman. ``BernhardPOS," July 2015. https://securitykitten.github.io/2015/07/14/bernhardpos.html. (accessd 2019-11-30).
 \bibitem{multigrainpos} Fireeye. ``MULTIGRAIN – Point of Sale Attackers Make an Unhealthy Addition to the Pantry," April 2016. https://www.fieeye.com/blog/threat-research/2016/04/multigrain\_pointo.html. (accessd 2019-11-30).
 \bibitem{pisloader} Palo alto Networks. ``New Wekby Attacks Use DNS Requests As Command and Control Mechanism," May 2016. https://unit42.paloaltonetworks.com/unit42-new-wekby-attacks-use-dns-requests-as-command-and-control-mechanism/. (accessd 2019-11-30).
 \bibitem{denis} Kaspersky. ``Use of DNS Tunneling for C\&C Communications," April 2017. https://securelist.com/use-of-dns-tunneling-for-cc-communications/78203/. (accessd 2019-11-30).
 \bibitem{dnsmessenger} CISCO Talos. ``Spoofed SEC Emails Distribute Evolved DNSMessenger," October 2017. https://blog.talosintelligence.com/2017/10/dnsmessenger-sec-campaign.html. (accessd 2019-11-30).
 \bibitem{udpos} Cylance. ``Threat Spotlight: Inside UDPoS Malware," Febrary 27 2018. https://threatvector.cylance.com/en\_us/home/threat-spotlight-inside-udpos-malware.html. (accessd 2019-11-30).
\end{thebibliography}
\bibliography{mthesis}




% ===================付録===================
\appendix

\section{発表リスト(国内研究会)}
%\subsection{国内研究会}
\begin{enumerate}
 \item \underline{高須賀 昌烈}, 妙中 雄三, 門林 雄基, ``非実在ドメインに対するネガティブキャッシュの拡張と再帰問い合わせハッシュ化の提案", 電子情報通信学会 情報ネットワーク研究会, 2019-10-ICTSSL-IN, 2019年10月.
\end{enumerate}
%\label{omake1}
%これはおまけです。これはおまけです。これはおまけです。これはおまけです。
%\begin{figure}
%\centerline{これはおまけの図です。}
%\caption{おまけの図}
%\end{figure}
%\section{おまけその２}
%これもおまけです。これもおまけです。これもおまけです。これもおまけです。



\end{document}

