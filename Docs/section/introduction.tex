\section{序論}
\subsection{背景}
%APT攻撃のような用意周到に秘匿通信する手法が利用されている背景から入る方がいいのかもしれない．
%他には，セキュリティ脅威対策におけるSOCエンジニアの業務の大半が誤検知とのハンドリングに時間を取られている背景から入るとか
%膨大なセキュリティアラートにおける優先度やアラートが誤検知であるのかないのかの判別に業務が取られるているという報告がある．
%これを引き合いに対して，そもそも設計の脆弱性を廃止することの必要性について問題提起するとか
%security soc false positive handling
%https://medium.com/analytics-vidhya/classification-of-false-positive-security-alerts-in-soc-environment-5b6fa97ac2ef
増加し続けているサイバー攻撃に対して，現在多くの組織は，SIEM\footnotetext{SIEM : Security Information and Event Management}のようなネットワークトラフィックを監視するシステムを導入し，そのシステムから発せられるアラートを処理することで脅威に対処している．
%しかし，実際の運用では，システムからのアラートの量は膨大であり，全てのアラートを完全に網羅することは人数的・スキル的要因により極めて困難である．
他方で，機密情報の奪取や諜報活動といった目的の実行者は，その活動について特定・解析されることを防止するために，通信を他の通信プロトコルに偽装させるという秘匿通信手法\footnotetext{秘匿通信 : 情報を不正・秘密裏に転送するために使用される回避通信手法}を用いることが知られている~\cite{mitre-custom-c2}．
この手法を用いることによって，先の監視システムを巧みに迂回しながら，秘密裏に目的を実行することができる．
このような秘匿通信手法を用いた攻撃に対処するには，従来のような通信の監視だけではなく，プロトコルの設計において悪用されないようなセキュア指向に基づき設計することが重要である．

しかし，現在利用されているネットワークプロトコルの中には，当初の設計のまま変更されることなく使用されているプロトコルがある．
DNS(Domain Name System)は，IPアドレスをはじめとしたドメイン名に関連づけられたリソースレコードを解決するシステムである．
DNSがユーザから問い合わせられたドメイン名のIPアドレスを解決してくれるおかげで，ユーザは識別しづらいIPアドレス(IPv4:``93.184.216.34", IPv6:``2606:2800:220:1:248:1893:25c8:1946")を直接入力することなく，サーバにアクセスすることができる．
このような利便性を実現するDNSによる名前解決の機能は，ユーザがインターネットを利活用する上で極めて重要である．
このため，DNSは多くの組織においてフィルタリングされることが少ない．
さらに，DNSのQnameやRdataに任意の文字列を注入できるという特性も持っているため，秘匿通信手法として都合が良く，DNSトンネリングは秘匿通信手法としてもっとも広く使用される秘匿手法である．
DNSトンネリングは，DNSクエリを利用することで外部情報に情報を流出させるだけでなく，事前にサーバに情報を登録しておくことで外部から内部方向に情報を転送できるという性質を持つ．
このため，DNSトンネリングは，ターゲット組織から取得したデータを外部に流出させる際の手段としてだけでなく，ターゲットネットワークに潜伏しているマルウェアに対するC2サーバ\footnotetext{C2サーバ : Command \& Controlサーバ}からの命令を送る手段として，実際のインシデントで広く利用されている~\cite{frameworkpos, bondupdater, bernhardpos, multigrainpos, pisloader, denis, dnsmessenger, udpos}．

これまで，DNSトンネリングに対する従来の対策としては，トラフィック特徴およびペイロード特徴に基づいた検知によるアプローチが取られてきた．
特にデータマイニングに基づき，閾値を推定する方法や悪性通信モデルを生成する方法は多数考案されている~\cite{born, cheng, liu, asaf, steadman, jawad}．
しかし，提案されてきた検知手法では，その多くが検知対象のDNSトンネリングの通信を，githubなどより一般に入手が可能なツールキット~\cite{ozymandns, iodine, dnscat2}によって用意されるトラフィックをサンプルとしている．
このようなツールキットによって生成されるトラフィックには，高いエントロピーや長いドメイン名といった顕著な特徴を示す特性があり，検知システムを迂回することを目的とするような実際の攻撃シーンにおけるDNSトンネリングとは異なる．
実際の攻撃において，使用されるような高い秘匿性を持つDNSトンネリング手法には，1回あたりの転送データ量を少なくする手法やパケット間のインターバルを長期間にする手法などがある~\cite{asaf}．
このようなツールキットではサンプリングできないより秘匿性を高めた手法に対して，従来の検知手法では検知することが困難である．
%悪意を持つユーザの視点として，1bitでも転送できることは秘匿通信として利用することができるため，転送量の少なさは軽視されるべきではない．

検知以外のアプローチには，DNSのアーキテクチャを変更することによる抑止手法が考えられる．
これまでに多数の次世代名前解決システムは提案されてきているが，DNSトンネリング抑止を目的としたシステムは筆者が知りうる限り確認されない．
%提案手法におけるゴールについてここで明言するべきなのかもしれない
%本研究では，DNSトンネリング抑止指向の名前解決システムを設計する際に以下の点に着目した．
%\begin{description}
% \item[DNSトンネリングへの耐性]
% \item[マイグレーション]
%\end{description}


\subsection{目的}
本研究は，DNSの名前解決の仕組みを悪用した秘匿通信手法のDNSトンネリングを抑止しながら，従来通りドメイン名に関連づけられたリソースレコード情報を解決できる機能を両立する名前解決システムを開発することを目的とする．

既存のDNSによる名前解決システムは，現在のインターネットの根幹技術であるため，その名前解決エコシステムに大幅な変更を加えることは，高い導入コストが要求されるため望まれない．
例えば，期待されないシステムとしては，以下のようなものが予想される．
\begin{enumerate}
 \setlength{\itemsep}{-0.5mm}
 \item DNSトンネリングの抑止の機能は実現できるが，リソースレコード情報の解決の機能がない
 \item DNSトンネリングの抑止の機能は実現できるが，既存システムからの大幅な変更が必要になり，未対応のコンピュータのインターネット接続に支障をきたす
\end{enumerate}
以上のことを踏まえて，既存システムのエコシステムとの互換性を保ちながら，目的を達成することが重要である．

提案システムは，既存システムにおけるクライアント・サーバアーキテクチャを流用しながら，既存の再帰問い合わせの仕組みのみに改変処理を施すことで，DNSトンネリングを抑止する名前解決システムの実現を目指す．
すなわち，提案システムは，スタブリゾルバとフルサービスリゾルバ間における処理はそのままに，フルサービスリゾルバと権威サーバ間における処理にのみ変更を加えることで，DNSのエコシステムとの互換性を保ちながら，DNSトンネリングを抑止することを実現する．
このような提案システムは，既存クライアントに変更を加えずに秘匿通信としての機能を抑止するため，セキュアな名前解決システムとして広く一般に利用されることが期待される．

%具体的な手法
%コンテンツを保持するサーバ同士を連携させ，リソースレコードを登録したいノードと実際にコンテンツの保持ノードを分離させることによって，DNSトンネリング抑止を実現させる．
%また，提案手法では，既存システムにおけるルート権威サーバを持たない設計になっており，現在問題となっているルート権威サーバにかかる集中的な負荷を分散することが期待される．
%さらに，再帰的な問い合わせでなく，コンテンツを保持するサーバが一意に決定される設計による，ネットワーク全体にかかるトラフィック量の削減に貢献することが期待される．
%高速に名前解決される特性から，次世代のコンテンツ情報指向のICNネットワークへの応用が期待される．
%他方で，DNSは初めに述べたように，現在のインターネットの根幹技術として根ざしており，抜本的な改変は期待されない．
%すなわち，既存のDNSによる名前解決のメカニズムに大幅な改変を加えないという制約下で，Tunnelingに対処することが現実的な最適解であると考える．




\subsection{本論構成}
本稿の構成は次の通りである．
第２章では，本論で対象とする脅威モデルであるDNSトンネリングを説明し，これまでの検知に基づくアプローチの限界を示す．
第３章では，これまでに提案されてきた名前解決システムについて説明し，DNSトンネリングに対する課題を示す．
第４章では，提案手法を説明する．
第５章では，提案手法のDNS Tunnelingに対する評価を行い，併せて提案手法の特定についても説明する．
第６章では，提案手法の課題について議論する．
最後に，第７章にて結論を述べる．
