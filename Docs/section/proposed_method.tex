\section{提案手法}
%\subsection{本研究の位置づけ}
%\subsection{脅威モデル}
\ref{sec:related-works}で述べたように，これまでに提案されてきた検知に基づくDNS Tunneling対策には，Low Throughput手法および転送頻度を下げる手法に対して，検知が困難であるという課題がある．
%他方，新しいアーキテクチャに基づく名前解決システムには，マイグレーションの課題が残留している．

本章では，上記内容を踏まえ，DNS Exfiltrationを防止する名前解決システムS-NRS(Supernode in P2P networks based Name Resolution System)について説明する．

\subsection{S-NRS}
\subsubsection{設計とアーキテクチャ}
S-NRSのアーキテクチャでは，役割に応じてノードは４つに大別することができる．
スタブリゾルバは既存のDNSと変更はなく，DNSクライアントとして，名前解決を依頼する主体として位置づくノードである．
リカーシブサーバは，スタブリゾルバからの問い合わせに対してリソース情報を保持する主体に代理的に問い合わせ機能と，問い合わせた情報を一定期間キャッシュするキャッシュサーバとして機能するノードである．
既存のDNSにおける権威サーバは，リカーシブサーバからの問い合わせに応答するマネージャと，リソース情報について作成・消去および更新などの操作をするプロバイダの二つに分けられる．
S-NRSにおいて，リソース情報は，オブジェクト(object)とリソースレコードタイプ(rtype)を引数とするハッシュ関数から算出されるコンテンツIDが紐づけられ，そのコンテンツIDに基づきハッシュ空間上に対応づけられる．
各マネージャは，ハッシュテーブル全体のうち連続した幾らかの管理範囲が割り当てられ，範囲下にあるコンテンツIDに基づいたリソース情報を保存・管理する．
このようにして，リソース情報は，特定の範囲ごとに分割されたハッシュテーブルにて分散的に管理される．
マネージャ同士は，フルメッシュなネットワーク構造で接続し合い，各マネージャには地理的・意味的に類似なプロバイダが階層的な序列に基づき接続される．

プロバイダからリソース情報への操作リクエストがあった際には，リソース情報のコンテンツIDを算出し，そのIDが含まれるハッシュ空間を管理する担当マネージャに操作依頼を転送し，受け取った担当マネージャは直ちに，リソース情報への操作を実行する．


%\begin{figure}[h]
% \centering
% \includegraphics[width=10.0cm]{images/spnrs-architecture.png}
% \caption{S-NRSによって，名前解決している様子．}
% \label{fig:spnrs-architecture}
%\end{figure}


%\subsubsection{想定する脅威}
%\subsubsection{名前解決メカニズム}
\subsubsection{通信プロトコル}
%\subsubsection{KVSモデルに基づく分散ハッシュテーブル}
\subsection{課題}
%\subsubsection{QNAMEとRRを引数とするハッシュ値をキーとするクエリ}
%\subsection{データベース}
