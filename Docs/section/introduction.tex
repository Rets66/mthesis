\section{序論}
\subsection{背景}
%APT攻撃のような用意周到に秘匿通信する手法が利用されている背景から入る方がいいのかもしれない．
%他には，セキュリティ脅威対策におけるSOCエンジニアの業務の大半が誤検知とのハンドリングに時間を取られている背景から入るとか
%膨大なセキュリティアラートにおける優先度やアラートが誤検知であるのかないのかの判別に業務が取られるているという報告がある．
%これを引き合いに対して，そもそも設計の脆弱性を廃止することの必要性について問題提起するとか
増加のし続けているサイバー攻撃に対して，現在多くの組織は，SIEM\footnotetext{SIEM : Security Information and Event Management. }のようなネットワークトラフィックを監視するシステムを導入し，そのシステムから発せられるアラートを処理することで脅威に対処している．
%しかし，実際の運用では，システムからのアラートの量は膨大であり，全てのアラートを完全に網羅することは人数的・スキル的要因により極めて困難である．
他方で，高度な手法で執拗に攻撃対象を狙う標的型攻撃において，その攻撃実行者は，悪性通信を通常通信に偽装させるといった秘匿手法を用いることが知られている．
この手法を用いることで，攻撃は先の監視システムを巧みに迂回しながら，秘密裏に目的を実行することができる．
このような秘匿通信\footnotetext{秘匿通信 : 情報を不正・秘密裏に転送するために使用される回避通信手法．}~\cite{covertchannel}手法を用いた攻撃に対処するために，通信の監視だけでなく，プロトコル設計段階で悪用されないセキュアな設計にすることが求められる．

攻撃者が使用する秘匿通信の中で，代表的な手法の一つにDNSトンネリングがある．
DNSトンネリングは，DNS(Domain Name System)と呼ばれるドメイン名に関連づけられた情報を解決する通信プロコトルを利用した秘匿通信手法である．
このDNSトンネリング手法は，DNSが持つ特性のうち，DNSが現在のインターネットにおいて極めて重要な位置づけにあり多くの組織でフィルタリングされることが少ないという特性と，他の秘匿通信手法と比べてより多く情報を注入できるという特性に基づいて機能する．
DNSトンネリングは，DNSクエリを利用することで外部情報に情報を流出させるだけでなく，事前にサーバに情報を登録しておくことで外部から内部方向に情報を転送できるという性質を持つ．
このため，DNSトンネリングは，ターゲット組織から取得したデータを外部に流出させる際の手段としてだけでなく，ターゲットネットワークに潜伏しているマルウェアに対するC2サーバ\footnotetext{C2サーバ : Command \& Controlサーバ．}からの命令を送る手段として，実際のインシデントで広く利用されている~\cite{frameworkpos, bondupdater, bernhardpos, multigrainpos, pisloader, denis, dnsmessenger, udpos}．

DNSトンネリングに対する従来の対策は，トラフィック特徴およびペイロード特徴に基づいた検知によるアプローチが取られてきた．
特にデータマイニングに基づき，閾値を推定する方法や悪性通信モデルを生成する方法は多数考案されている~\cite{born, cheng, liu, asaf, steadman, jawad}．
提案されてきた検知手法では，その多くが検知対象のDNSトンネリングの通信を，githubなどより一般に入手が可能なツールキット~\cite{ozymandns, iodine, dnscat2}によって用意されるトラフィックをサンプルとしている．
しかし，ツールキットによって生成されるトラフィックは顕著な特徴を示す特性があり，検知システムを迂回することを目的として使用される実際の攻撃シーンにおけるDNSトンネリングとは異なることが予想される．
秘匿性を高めたDNSトンネリング手法には，1回あたりの転送データ量を少なくする手法やパケット間のインターバルを長期間にする手法などがある~\cite{asaf}．
このようなツールキットではサンプリングできないより秘匿性を高めた手法に対して，従来の検知手法では検知することが困難である．
%悪意を持つユーザの視点として，1bitでも転送できることは秘匿通信として利用することができるため，転送量の少なさは軽視されるべきではない．

検知以外のアプローチには，DNSのアーキテクチャを変更することによる抑止手法が考えられる．
これまでに多数の次世代名前解決システムは提案されてきているが，DNSトンネリング抑止を目的としたシステムは筆者が知りうる限り確認されない．
%提案手法におけるゴールについてここで明言するべきなのかもしれない
%本研究では，DNSトンネリング抑止指向の名前解決システムを設計する際に以下の点に着目した．
%\begin{description}
% \item[DNSトンネリングへの耐性]
% \item[マイグレーション]
%\end{description}


\subsection{目的}
本研究は，DNSを用いた秘匿通信の発生を抑止することを目的に，新しい名前解決手法を提案する．
アーキテクチャを変更にするあたり，既存システムとの互換性をどのように担保しながら，移行させるのかという問題がある．
提案手法では，現実のDNSとして利用されることを考慮して，フルサービスリゾルバとコンテンツを保持するサーバノードのみに変更点を加えることに留めた．
すなわち，コンテンツを保持するサーバ同士を連携させ，リソースレコードを登録したいノードと実際にコンテンツの保持ノードを分離させることによって，DNSトンネリング抑止を実現させる．
また，提案手法では，既存システムにおけるルート権威サーバを持たない設計になっており，現在問題となっているルート権威サーバにかかる集中的な負荷を分散することが期待される．
さらに，再帰的な問い合わせでなく，コンテンツを保持するサーバが一意に決定される設計による，ネットワーク全体にかかるトラフィック量の削減に貢献することが期待される．
%高速に名前解決される特性から，次世代のコンテンツ情報指向のICNネットワークへの応用が期待される．
本提案手法は，次世代の名前解決システムにおけるDNSトンネリングを抑止する際のアプローチとして応用されることが期待される．
%他方で，DNSは初めに述べたように，現在のインターネットの根幹技術として根ざしており，抜本的な改変は期待されない．
%すなわち，既存のDNSによる名前解決のメカニズムに大幅な改変を加えないという制約下で，Tunnelingに対処することが現実的な最適解であると考える．




\subsection{本論構成}
本稿の構成は次の通りである．
第２章では，本論に対象とする脅威モデルであるDNSトンネリングについて説明する．
第３章では，これまでに提案されてきた名前解決システムについて説明し，DNSトンネリングに対する課題を示す．
第４章では，提案手法を説明する．
第５章では，提案手法のDNS Tunnelingに対する評価を行い，併せて提案手法の特定についても説明する．
第６章では，提案手法の課題について議論する．
最後に，第７章にて結論を述べる．
