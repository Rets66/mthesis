\section{序論}
\subsection{背景}
%APT攻撃のような用意周到に秘匿通信する手法が利用されている背景から入る方がいいのかもしれない．
%他には，セキュリティ脅威対策におけるSOCエンジニアの業務の大半が誤検知とのハンドリングに時間を取られている背景から入るとか
%膨大なセキュリティアラートにおける優先度やアラートが誤検知であるのかないのかの判別に業務が取られるているという報告がある．
%これを引き合いに対して，そもそも設計の脆弱性を廃止することの必要性について問題提起するとか
%security soc false positive handling
%https://medium.com/analytics-vidhya/classification-of-false-positive-security-alerts-in-soc-environment-5b6fa97ac2ef
増加し続けているサイバー攻撃に対して，現在多くの組織は，SIEM\footnote{SIEM(Security Information and Event Management) : 複数のソフトウェアや機器からトラフィックなどのログ情報を一元的に管理し，異常や脅威が発生した時に管理者に通知する仕組み}のようなネットワークトラフィックを監視するシステムから発せられるアラートを処理することで脅威に対処している．
%しかし，実際の運用では，システムからのアラートの量は膨大であり，全てのアラートを完全に網羅することは人数的・スキル的要因により極めて困難である．
他方で，機密情報の奪取や諜報活動を行う攻撃者は，そのような監視システムを迂回するために，秘匿通信手法\footnote{秘匿通信 : 情報を不正・秘密裏に転送するために使用される回避通信手法}を用いることが知られている~\cite{mitre-custom-c2}．
このような攻撃に対して，検知の閾値や悪性モデルを調整するアプローチが考えられるが，誤検知とのトレードオフの関係にある．
通信プロトコルは，このような秘匿通信として利用されないように，セキュア指向で設計されているが重要である．
%従来のような通信の監視だけではなく，プロトコルの設計において悪用されないようなセキュア指向に基づき設計することが重要である．
%このような秘匿通信手法を用いた攻撃に対処するには，

秘匿通信として代表的な手法が，DNSトンネリングである．
本来，DNS(Domain Name System)は，IPアドレスをはじめとしたドメイン名に関連づけられたリソースレコードを解決するシステムである．
DNSによるこの仕組みは名前解決と呼ばれ，ユーザはこの仕組みを利用することで，識別子づらいIPアドレスを直接利用することなくサーバのリソースにアクセスすることができる．
インターネットの利用において，名前解決はメールの送受信やウェブ検索など全ての通信に先立って行われるため，一般にDNSのトラフィックをフィルタリングすることはインターネットの利活用に支障が生じる．
DNSトンネリングは，DNSがフィルタリングされにくいというこの特性を利用することで，容易に秘匿通信として機能する．
また，DNSの名前解決の仕組みは，クライアントからの問い合わせがサーバで処理され，サーバは問い合わせの結果をクライアントに応答することによって成り立っている．
DNSトンネリングでは，この名前解決においてデータが双方向に転送される仕組みを悪用することで，任意データの転送を実現させている．
このため，DNSトンネリングは，ターゲット組織から取得したデータを外部に流出させる際の手段としてだけでなく，ターゲットネットワークに潜伏しているマルウェアに対するC2サーバ\footnote{C2サーバ : Command \& Controlサーバ}からの命令を送る手段として，サイバー攻撃で広く利用されている~\cite{frameworkpos, bondupdater, bernhardpos, multigrainpos, pisloader, denis, dnsmessenger, udpos}．
このような課題があるにも関わらず，DNSの名前解決の仕組みは，設計当初のまま変更されることなく使用されている現状にある．
%現在利用されているネットワークプロトコルの中には，前述のような問題を抱えていることが発覚したにも関わらず，当初の設計のまま変更されることなく使用されているプロトコルがある．
%その一つにDNS(Domain Name System)がある．
%DNSは，IPアドレスをはじめとしたドメイン名に関連づけられたリソースレコードを解決するシステムである．
%DNSの名前解決の機能を利用することで，ユーザは識別子づらいIPアドレスを直接利用することなく，サーバのリソースにアクセスすることができる．
%DNSは，このように頻繁に使用される重要なプロトコルであるため，一般にフィルタリングされることが少ない．
%また，名前解決というシンプルな機能であることから，悪用されやすいプロトコルでもある．
%DNSを悪用した手法の一つに秘匿通信手法の一種であるDNSトンネリングがある．
%DNSトンネリングは，DNSの名前解決機能におけるクライアントからサーバ方向またはその逆方向にデータが転送される特性と，フィルタリングされることが少ないという特性を利用することで，
%秘匿性を実現した最も代表的な秘匿通信手法である．
%このような利便性を実現するDNSの役割は，ユーザがインターネットを利活用する上で極めて重要である．
%このため，DNSは一般的にフィルタリングされることが少ない．
%さらに，DNSのQnameやRdataには任意の文字列を注入できるという特性がある．
%そのため，フィルタリングされることが少ない特性と併せて秘匿通信手法として都合が良い．
%このため，秘匿通信手法の一つであるDNSトンネリングは，もっとも広く使用されている．
%DNSトンネリングは，DNSクエリを利用することで外部に情報を流出させることができ，逆に事前にサーバに情報を登録しておくことで外部から内部方向に情報転送を実現させている．
%このため，DNSトンネリングは，ターゲット組織から取得したデータを外部に流出させる際の手段としてだけでなく，ターゲットネットワークに潜伏しているマルウェアに対するC2サーバ\footnote{C2サーバ : Command \& Controlサーバ}からの命令を送る手段として，サイバー攻撃で広く利用されている~\cite{frameworkpos, bondupdater, bernhardpos, multigrainpos, pisloader, denis, dnsmessenger, udpos}．
%データマイニングという言葉をより明確な表現に置き換えたい
%ここでは何を伝えたいかというと，従来の検知手法ではツール特性に依存する傾向にあり，秘匿性の高い手法には効果が期待できないという点
DNSトンネリングに対して，同一ドメインに対する時間あたりのトラフィック頻度や問い合わせられるドメイン名のサブドメインにおける文字列の分布や長さといった特徴に基づいた検知アプローチがこれまでに多数提案されている~\cite{born, cheng, liu, asaf, steadman, jawad}．
それら検知手法における評価では，DNSトンネリングの擬似通信として，Github\footnote{Github : ソースコード共有プラットフォーム}より入手可能なトンネリング実装プログラムが用いられている．
多くの先行研究で検知対象となっているIodine~\cite{iodine}やDNSCat2~\cite{dnscat2}などのトンネリング実装は，DNSを用いたインタラクティブシェルを目的としており，そのため時間あたりに高いトラフィック量となる特性がある．
%また，トンネリング実装の多くが転送速度を重視する設計になっており，正規のドメイン名の平均がxであるのに対して，Iodineでは200bytesと顕著な違いがある．
このような顕著な特性を示すトンネリング実装に対して，パケットごとのインターバルを1ヶ月間などトラフィック頻度を調整したり，正規のFQDNの平均の長さまで注入するデータ量を下げるなどによる秘匿性を高めたアプローチがある~\cite{asaf}．
これら秘匿性を高めた秘匿手法を利用した場合，トンネリング実装のような顕著な特徴量が現れないため，検知することが極めて困難である．
%このような検知システムを迂回するアプローチでは特徴量が現れづらく，高い誤検知が課題になることが予想され，検知に基づくアプローチの限界と捉えられる．
%悪意を持つユーザの視点として，1bitでも転送できることは秘匿通信として利用することができるため，転送量の少なさは軽視されるべきではない．

これまでに多数の次世代名前解決システムは提案されてきているが，DNSトンネリング抑止を目的としたシステムは筆者が知りうる限り提案されていない．
%検知以外のアプローチには，DNSのアーキテクチャを変更することによる抑止手法が考えられる．
そこで本研究では，秘匿通信手法であるDNSトンネリングの発生を抑止する次世代の名前解決システムを提案する．
%提案手法におけるゴールについてここで明言するべきなのかもしれない
%本研究では，DNSトンネリング抑止指向の名前解決システムを設計する際に以下の点に着目した．
%\begin{description}
% \item[DNSトンネリングへの耐性]
% \item[マイグレーション]
%\end{description}


\subsection{目的}
本研究は，DNSの名前解決の仕組みを悪用した秘匿通信手法のDNSトンネリングを抑止しながら，従来通りドメイン名に関連づけられたリソースレコード情報を解決できる機能を両立する名前解決システムを開発することを目的とする．

既存のDNSによる名前解決システムは，現在のインターネットの根幹技術であるため，その名前解決エコシステムに大幅な変更を加えることは，高い導入コストが要求されるため望まれない．
例えば，期待されないシステムとしては，以下のようなものが予想される．
\begin{enumerate}
 \setlength{\itemsep}{-0.5mm}
 \item DNSトンネリングの抑止の機能は実現できるが，リソースレコード情報の解決の機能がない
 \item DNSトンネリングの抑止の機能は実現できるが，既存システムからの大幅な変更が必要になり，未対応のコンピュータのインターネット接続に支障をきたす
\end{enumerate}
以上のことを踏まえて，既存システムのエコシステムとの互換性を保ちながら，目的を達成することが重要である．

\subsection{貢献}
提案システムは，既存システムにおけるクライアント・サーバアーキテクチャを流用しながら，既存の再帰問い合わせの仕組みのみに改変処理を施すことで，DNSトンネリングを抑止する名前解決システムの実現を目指す．
すなわち，提案システムは，スタブリゾルバとフルサービスリゾルバ間における処理はそのままに，フルサービスリゾルバと権威サーバ間における処理にのみ変更を加えることで，DNSのエコシステムとの互換性を保ちながら，DNSトンネリングを抑止することを実現する．
提案システムでは，既存クライアントに変更を加えずに秘匿通信としての機能を抑止することができるため，セキュアな名前解決システムとして広く一般に利用されることが期待される．

%具体的な手法
%コンテンツを保持するサーバ同士を連携させ，リソースレコードを登録したいノードと実際にコンテンツの保持ノードを分離させることによって，DNSトンネリング抑止を実現させる．
%また，提案手法では，既存システムにおけるルート権威サーバを持たない設計になっており，現在問題となっているルート権威サーバにかかる集中的な負荷を分散することが期待される．
%さらに，再帰的な問い合わせでなく，コンテンツを保持するサーバが一意に決定される設計による，ネットワーク全体にかかるトラフィック量の削減に貢献することが期待される．
%高速に名前解決される特性から，次世代のコンテンツ情報指向のICNネットワークへの応用が期待される．
%他方で，DNSは初めに述べたように，現在のインターネットの根幹技術として根ざしており，抜本的な改変は期待されない．
%すなわち，既存のDNSによる名前解決のメカニズムに大幅な改変を加えないという制約下で，Tunnelingに対処することが現実的な最適解であると考える．




\subsection{本論構成}
本稿の構成は次の通りである．
第２章では，本論で対象とする脅威モデルであるDNSトンネリングを説明し，これまでの検知に基づくアプローチの限界を示す．
第３章では，これまでに提案されてきた名前解決システムについて説明し，DNSトンネリングに対する課題を示す．
第４章では，提案手法を説明する．
第５章では，提案手法のDNSトンネリングに対する評価を行い，併せて提案手法の特定についても説明する．
第６章では，提案手法の課題について議論する．
最後に，第７章にて結論を述べる．
