# 研究のターゲット
* 修士論文としての集大成
  ** 秘匿通信に調査論文 **
  {DNS, SCADA, 画像, Cloud, TCP/IP}
* 研究会に関しては，DNSを利用した秘匿通信

# 研究の対象と目的
- DNS Tunnelingの効率的な検知システムの構築．
ドメイン検証を利用した秘匿経路に関しては，検知を実現できるシステムが未だ登場していない．
- Liuらによる既存の検知システムでは，リクエストに関する特徴に着目していたが，レスポンスを考慮することによってさらに検知率は向上するのではないか．
- ShuoXuらは，悪性ドメインを検知することを目的として，DNSレスポンスについて着目している．DNS Tunneling検知のためではないため，若干異なる．
- ドメインサイズの長さが長いものに対して，ホワイトリストを作成することによって大きく対処することができるのはないか．
- 本来，ドメイン検証を利用する目的があるのは，サービス規模がグローバルなものに限定されるのだから．
- ドメイン検証を複数利用するユーザの統計データを取得したい．
 - 単一のドメイン検証を利用しているドメインがどのくらいあるのかの調査が必要
 - Facebookが登録を義務化したり，Googleでの検索結果へ影響することから，高い利用率が予想される．
 - DNS のtxtレコードのクローリングは，必要になるのかもしれない
- ドメイン検証を組み合わせることによる，データ量を増加せる手法の登場が予想される
- リアルタイムに検知を実現しようとすると，エントロピーの計算がオーバーヘッドになることが予想される．
- 過去の研究では，検知率に焦点が向かっているがスピードに焦点が当てられている論文が確認することができない．
- アプローチは，ドメイン検証の文字頻度ではなく，複数特徴を活用した手法で対策する

# 研究の課題
DNS のQNAME および レコード領域を利用することによって，各種検知システムをバイパスできる脆弱性がある．
既存の検知
  そのうち，攻撃元のトレースを回避するために，秘匿通信を利用するものがある．DNSは，現代インターネットの根幹技術に位置づいている．近年，このDNSをデータを転送するキャリアとして利用する秘匿通信手法が実際のC2通信に利用される例が増えてきている．具体的な手法というのが，DNSクエリのペイロード中に含まれるDomeinのラベルとして，抽出した情報をネーミングするというものである．この手法によって，生成されたラベルは，抽出情報の内容秘匿のために暗号処理が施される傾向にある．そのため，そのラベルは，'laksdlkfhlkjdsnflka.example.com'のように高いエントロピーを示す傾向がある．また別の手法としては，エントロピーを下げるために，事前に用意した対応法を用いて英単語など怪しまれないラベルの生成を試みるものも登場している．検知アプローチとしては，先行研究では，エントロピーに着目したもの，そしてラベル長に着目したものがある．これらの手法の課題は，オーバーブロッキングという課題がある．またさらに，近年非暗号方式のDNSプロトコルをHTTPSやTLSなどの暗号処理を施そうといて試みが登場している．例えば，DOH(DNS over HTTPS)は，スタブリゾルバからフルリゾルバまでの通信はHTTPSを利用して暗号化する技術が登場している．この技術では，Man in the middle攻撃など中間地点からの覗きを防止することには繋がるが，ペイロードが暗号化される分，DNS Covert Channelとしては，攻撃者優位の環境になる可能性が考えられる．また，これまでの研究では，DNSログの取得によって，不審なリクエストを機械学習的アプローチで判別しようとする試みがある．しかし，DNSクエリは，ウェブリクエストごとに登場しているため，ログの使用によって，膨大なデータが求められるだけでなく，ネットワークパフォーマンスを低下することが懸念される．
  さらに，サブドメインを利用した手法は，ランダムサブドメイン攻撃(DNS水責め攻撃)というDos攻撃として機能するため，サブドメインに制約を付与することによって，ネットワーク全体に不審なクエリをもつパケットを減少させることは非常に重要であると考える．
  このような状況において，私は，以下の3つのMitigationを考えた．
    - ラベルの命名規則に制約を施すことが重要であると考える．
      - 問題を深刻にさせている要因：gTLDの増加(Now over 1,200)
      - 英語以外の言語を利用したドメインの普及
    - ネットワークパフォーマンスを低下させない不審ラベルの検知の実現

## 研究のScope
* Fast Flux手法もしくは，APT攻撃を想定したDNS Exfil
* 次世代DNS Exfiltration
* DoHを利用したOutcoming手法
* 既存のDLPの特徴
  - webやemail,FTPをターゲットとしている点など
  - DNSをスコープに含めたDLPソリューションの提案？

# DNS tunnelnig の検知手法マップ
* Machine learning
* Signature
* SDN

# DNSを利用したデータ転送手法のマップ作成
* 既存のソリューションのまとめ
  - ベンダーが提供する既知のブラックホストに頼っている現状
  - 2つのパターン[Signature/Behavorial]

# Covert Channel対策の対象とする領域
  * 種類
    - Storage
      - Header : 
      - Payload : 
    - Timing

    - IDS, Firewallを回避して送受信を実現する
      <前提>
      - IDS, Firewallが検知する際に着目点：
	5タプル[Address(Des, Src), Port(Des, Src), Protocol]
      - データ転送用のプロトコルをフィルターにかける
	[ftp, scp, sftp, http...etc]

# DNS Tunnelingの検知対策
  keyword : 誤検知後，ホワイトリスト登録
    - 内容 : 長さなどをフィルターに運用すると誤検知することがあるが，一定期間後に，
    　　　　　誤検知したドメインをホワイトリストに登録作業を繰り返すと，誤検知率は低減できる．
